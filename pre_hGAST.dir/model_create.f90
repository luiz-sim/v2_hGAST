!---------------------------------------------------------------------------------------------------------------------------------------------------!
!   National Technical University of Athens                                              Giannis Serafeim                                           !
!   School of Mechanical Engineering                                                     Dip. Mechanical Engineering - Phd Student                  !
!   Fluids Section                                                                       seraf@fluid.mech.ntua.gr                                   !
!   Laboratory of Aerodynamics                                                           Tuesday, 04 23:13 Jun 2019 - Athens, Greece                !
!---------------------------------------------------------------------------------------------------------------------------------------------------!
program model_create

   implicit none
   integer(4)::i, j, k                                                          ! counters
   real(8)::ukn                                                                 ! undefined variable
   real(8)::twist_or(1:30), twist_re(1:30)                                      ! twist angle for original and twist angle for retwist
   real(8)::rad30(1:30), x_swep(1:30), z_pre(1:30), cho30(1:30), twi30(1:30)    ! radius, sweep, prebend, chord, twist ---> construction of blades
   real(8)::rad41(1:41), cho41(1:41), twi41(1:41), x_aer41(1:41), z_aer41(1:41) ! radius, chord, twist, x_air, z_air ---> airodynamics of blades
   real(8)::stif(1:6,1:6,1:30), mass(1:6,1:6,1:30)                              ! stiffness and mass matrices
   real(8)::mach(1:30,1:27)                                                     ! machi matrix
   character(len=100)::path_dir                                                 ! path direct

   read(*,"(a)") path_dir

   ! initial
   !--->
      call system("cp -r /home/seraf/hGAST/pre_hGAST.dir/model_or/ "//trim(adjustl(path_dir))//"/model")
   !--->

   ! read data of blade's construction
   !--->
      open(unit=1, file=trim(adjustl(path_dir))//"/data.dir/blade_construction.dat")
         read(1,*)
         do i=1,30
            read(1,*) ukn, rad30(i), x_swep(i), z_pre(i), cho30(i), twist_or(i), twist_re(i)
            twi30(i)=twist_or(i)+twist_re(i)
         end do
      close (1)
   !--->

   ! read stiffness and mass matrices
   !--->
      open(unit=1, file=trim(adjustl(path_dir))//"/other.dir/matrix_hGAST.dat")
         do i=1,30
            read(1,*)
            do j=1,6
               read(1,*) (stif(j,k,i), k=1,6)
            end do
            read(1,*)
            do j=1,6
               read(1,*) (mass(j,k,i), k=1,6)
            end do
         end do
      close (1)
   !--->

   ! calculate machi matrix
   !--->
      do i=1,30
         mach(i,1)=mass(1,1,i)  ; mach(i,2)=mass(2,6,i)/mass(1,1,i) ; mach(i,3)=mass(1,5,i)/mass(1,1,i) ; mach(i,4)=mass(4,4,i)  ; mach(i,5)=mass(6,6,i)  ; mach(i,6)=-mass(4,6,i) ; mach(i,7)=0.55*stif(1,1,i) ; mach(i,8)=stif(1,2,i)  ; mach(i,9)=stif(1,3,i)
         mach(i,10)=stif(1,4,i) ; mach(i,11)=0.50*stif(1,5,i)       ; mach(i,12)=stif(1,6,i)            ; mach(i,13)=stif(2,2,i) ; mach(i,14)=stif(2,3,i) ; mach(i,15)=stif(2,4,i) ; mach(i,16)=stif(2,5,i)     ; mach(i,17)=stif(2,6,i) ; mach(i,18)=0.65*stif(3,3,i)
         mach(i,19)=stif(3,4,i) ; mach(i,20)=0.50*stif(3,5,i)       ; mach(i,21)=stif(3,6,i)            ; mach(i,22)=stif(4,4,i) ; mach(i,23)=stif(4,5,i) ; mach(i,24)=stif(4,6,i) ; mach(i,25)=stif(5,5,i)     ; mach(i,26)=stif(5,6,i) ; mach(i,27)=stif(6,6,i)
      end do
   !--->

   ! write "machi.inp"
   !--->
      open(unit=1, file=trim(adjustl(path_dir))//"/model/machi.inp")
         write(1,"(a)") "***Beam Characteristics of INNWIND 10MW wind turbine ***"
         do i=1,3
            write(1,"(a)") "***BLADE"
            write(1,"(a)") "1.00000, 2 !mass imbalance, iread"
            write(1,"(a)") "**num   Y   X[swe]   Z[ben]   m   x_cg   z_cg   ρTxx   ρIzz   ρIxz   GxA   K12   GxzA   k14   GxAx   k16   EA   k23   -EAx   EAy   EAz   GzA   k34   -GzAz   k36   EIxx   -EIxy   -EIxz   GI   -EIyz   EIzz   D"
            do j=1,29
               write(1,"(i3,3x,30(f25.5,3x),a)") j, (rad30(j)-2.80), x_swep(j), z_pre(j), (mach(j,k), k=1,27), "0"
               write(1,"(6x,30(f25.5,3x),a)")       (rad30(j+1)-2.80), x_swep(j+1), z_pre(j+1), (mach((j+1),k), k=1,27), "0"
            end do
         end do
         write(1,"(a)") "** SHAFT"
         write(1,"(a)") " 1.0000, 0 !mass imbalanc, iread"
         write(1,"(a)") "**num  y        x        z       m        xcm      zcm      mIxx        mIzz        mIxz          EA         EAx        EAz         EIxx        EIzz         EIxz        GIt         GAx        GAz        GAxx        GAzz       D[m]"
         write(1,"(a)") " 1  0.0000   0.0000   0.0000   1.000   0.0000   0.0000  0.1000E+00  0.1000E+00  0.0000E+00  0.1000E+12  0.0000E+00  0.0000E+00  0.1000E+12  0.1000E+12  0.0000E+00  1.7482E+10  1.0000E+16  1.0000E+16  0.00000000  0.00000000  0.000"
         write(1,"(a)") "    4.4000   0.0000   0.0000   1.000   0.0000   0.0000  0.1000E+00  0.1000E+00  0.0000E+00  0.1000E+12  0.0000E+00  0.0000E+00  0.1000E+12  0.1000E+12  0.0000E+00  1.7482E+10  1.0000E+16  1.0000E+16  0.00000000  0.00000000  0.000"
         write(1,"(a)") " 2  4.4000   0.0000   0.0000   1.000   0.0000   0.0000  0.1000E+00  0.1000E+00  0.0000E+00  0.1000E+12  0.0000E+00  0.0000E+00  0.1000E+12  0.1000E+12  0.0000E+00  1.7482E+10  1.0000E+16  1.0000E+16  0.00000000  0.00000000  0.000"
         write(1,"(a)") "    7.1000   0.0000   0.0000   1.000   0.0000   0.0000  0.1000E+00  0.1000E+00  0.0000E+00  0.1000E+12  0.0000E+00  0.0000E+00  0.1000E+12  0.1000E+12  0.0000E+00  1.7482E+10  1.0000E+16  1.0000E+16  0.00000000  0.00000000  0.000"
         write(1,"(a)") "** Tower  Innwind onshore Tower (starts at z = 0m)"
         write(1,"(a)") " 1.0000, 0 !mass imbalance, iread"
         write(1,"(a)") "**num     y     x      z         m        xcm    zcm      mIzz             mIxx        mIxz       EA          EAx     EAz       EIxx           EIzz         EIxz        GIt             GAx            GAz        GAxx    GAzz   D[m]"
         write(1,"(a)") " 1   0.000  0.000  0.000  8383.73584  0.000  0.000 0.71536414E+05 0.71536414E+05  0.000 0.20712759E+12  0.000  0.000 0.17673702E+13 0.17673702E+13  0.000 0.13595156E+13 0.42222163E+11 0.42222163E+11  0.000  0.000  8.300"
         write(1,"(a)") "     5.750  0.000  0.000  8242.44703  0.000  0.000 0.67980323E+05 0.67980323E+05  0.000 0.20363693E+12  0.000  0.000 0.16795139E+13 0.16795139E+13  0.000 0.12919337E+13 0.41510604E+11 0.41510604E+11  0.000  0.000  8.161"
         write(1,"(a)") " 2   5.750  0.000  0.000  8242.44703  0.000  0.000 0.67980323E+05 0.67980323E+05  0.000 0.20363693E+12  0.000  0.000 0.16795139E+13 0.16795139E+13  0.000 0.12919337E+13 0.41510604E+11 0.41510604E+11  0.000  0.000  8.161"
         write(1,"(a)") "    11.500  0.000  0.000  8101.15823  0.000  0.000 0.64544079E+05 0.64544079E+05  0.000 0.20014626E+12  0.000  0.000 0.15946184E+13 0.15946184E+13  0.000 0.12266296E+13 0.40799046E+11 0.40799046E+11  0.000  0.000  8.022"
         write(1,"(a)") " 3  11.500  0.000  0.000  7676.68086  0.000  0.000 0.61192289E+05 0.61192289E+05  0.000 0.18965917E+12  0.000  0.000 0.15118095E+13 0.15118095E+13  0.000 0.11629304E+13 0.38661293E+11 0.38661293E+11  0.000  0.000  8.022"
         write(1,"(a)") "    17.250  0.000  0.000  7542.83995  0.000  0.000 0.58047194E+05 0.58047194E+05  0.000 0.18635252E+12  0.000  0.000 0.14341072E+13 0.14341072E+13  0.000 0.11031594E+13 0.37987244E+11 0.37987244E+11  0.000  0.000  7.882"
         write(1,"(a)") " 4  17.250  0.000  0.000  7542.83995  0.000  0.000 0.58047194E+05 0.58047194E+05  0.000 0.18635252E+12  0.000  0.000 0.14341072E+13 0.14341072E+13  0.000 0.11031594E+13 0.37987244E+11 0.37987244E+11  0.000  0.000  7.882"
         write(1,"(a)") "    23.000  0.000  0.000  7408.99904  0.000  0.000 0.55011756E+05 0.55011756E+05  0.000 0.18304586E+12  0.000  0.000 0.13591140E+13 0.13591140E+13  0.000 0.10454723E+13 0.37313194E+11 0.37313194E+11  0.000  0.000  7.743"
         write(1,"(a)") " 5  23.000  0.000  0.000  6999.18183  0.000  0.000 0.51995392E+05 0.51995392E+05  0.000 0.17292096E+12  0.000  0.000 0.12845920E+13 0.12845920E+13  0.000 0.98814773E+12 0.35249273E+11 0.35249273E+11  0.000  0.000  7.743"
         write(1,"(a)") "    28.750  0.000  0.000  6872.77653  0.000  0.000 0.49228886E+05 0.49228886E+05  0.000 0.16979801E+12  0.000  0.000 0.12162431E+13 0.12162431E+13  0.000 0.93557160E+12 0.34612671E+11 0.34612671E+11  0.000  0.000  7.604"
         write(1,"(a)") " 6  28.750  0.000  0.000  6872.77653  0.000  0.000 0.49228886E+05 0.49228886E+05  0.000 0.16979801E+12  0.000  0.000 0.12162431E+13 0.12162431E+13  0.000 0.93557160E+12 0.34612671E+11 0.34612671E+11  0.000  0.000  7.604"
         write(1,"(a)") "    34.500  0.000  0.000  6746.37122  0.000  0.000 0.46562295E+05 0.46562295E+05  0.000 0.16667505E+12  0.000  0.000 0.11503626E+13 0.11503626E+13  0.000 0.88489430E+12 0.33976069E+11 0.33976069E+11  0.000  0.000  7.465"
         write(1,"(a)") " 7  34.500  0.000  0.000  6351.21419  0.000  0.000 0.43858198E+05 0.43858198E+05  0.000 0.15691235E+12  0.000  0.000 0.10835555E+13 0.10835555E+13  0.000 0.83350422E+12 0.31985979E+11 0.31985979E+11  0.000  0.000  7.465"
         write(1,"(a)") "    40.250  0.000  0.000  6232.24449  0.000  0.000 0.41439477E+05 0.41439477E+05  0.000 0.15397310E+12  0.000  0.000 0.10237988E+13 0.10237988E+13  0.000 0.78753758E+12 0.31386824E+11 0.31386824E+11  0.000  0.000  7.325"
         write(1,"(a)") " 8  40.250  0.000  0.000  6232.24449  0.000  0.000 0.41439477E+05 0.41439477E+05  0.000 0.15397310E+12  0.000  0.000 0.10237988E+13 0.10237988E+13  0.000 0.78753758E+12 0.31386824E+11 0.31386824E+11  0.000  0.000  7.325"
         write(1,"(a)") "    46.000  0.000  0.000  6113.27480  0.000  0.000 0.39111359E+05 0.39111359E+05  0.000 0.15103385E+12  0.000  0.000 0.96628063E+12 0.96628063E+12  0.000 0.74329279E+12 0.30787669E+11 0.30787669E+11  0.000  0.000  7.186"
         write(1,"(a)") " 9  46.000  0.000  0.000  5732.77793  0.000  0.000 0.36697197E+05 0.36697197E+05  0.000 0.14163334E+12  0.000  0.000 0.90663664E+12 0.90663664E+12  0.000 0.69741280E+12 0.28871411E+11 0.28871411E+11  0.000  0.000  7.186"
         write(1,"(a)") "    51.750  0.000  0.000  5621.24384  0.000  0.000 0.34596735E+05 0.34596735E+05  0.000 0.13887779E+12  0.000  0.000 0.85474287E+12 0.85474287E+12  0.000 0.65749452E+12 0.28309703E+11 0.28309703E+11  0.000  0.000  7.047"
         write(1,"(a)") "10  51.750  0.000  0.000  5621.24384  0.000  0.000 0.34596735E+05 0.34596735E+05  0.000 0.13887779E+12  0.000  0.000 0.85474287E+12 0.85474287E+12  0.000 0.65749452E+12 0.28309703E+11 0.28309703E+11  0.000  0.000  7.047"
         write(1,"(a)") "    57.500  0.000  0.000  5509.70975  0.000  0.000 0.32577994E+05 0.32577994E+05  0.000 0.13612224E+12  0.000  0.000 0.80486808E+12 0.80486808E+12  0.000 0.61912929E+12 0.27747995E+11 0.27747995E+11  0.000  0.000  6.908"
         write(1,"(a)") "11  57.500  0.000  0.000  5143.87306  0.000  0.000 0.30432265E+05 0.30432265E+05  0.000 0.12708392E+12  0.000  0.000 0.75185596E+12 0.75185596E+12  0.000 0.57835073E+12 0.25905569E+11 0.25905569E+11  0.000  0.000  6.908"
         write(1,"(a)") "    63.250  0.000  0.000  5039.77457  0.000  0.000 0.28621816E+05 0.28621816E+05  0.000 0.12451208E+12  0.000  0.000 0.70712721E+12 0.70712721E+12  0.000 0.54394401E+12 0.25381308E+11 0.25381308E+11  0.000  0.000  6.768"
         write(1,"(a)") "12  63.250  0.000  0.000  5039.77457  0.000  0.000 0.28621816E+05 0.28621816E+05  0.000 0.12451208E+12  0.000  0.000 0.70712721E+12 0.70712721E+12  0.000 0.54394401E+12 0.25381308E+11 0.25381308E+11  0.000  0.000  6.768"
         write(1,"(a)") "    69.000  0.000  0.000  4935.67609  0.000  0.000 0.26884633E+05 0.26884633E+05  0.000 0.12194023E+12  0.000  0.000 0.66420859E+12 0.66420859E+12  0.000 0.51092968E+12 0.24857047E+11 0.24857047E+11  0.000  0.000  6.629"
         write(1,"(a)") "13  69.000  0.000  0.000  4584.49957  0.000  0.000 0.24986663E+05 0.24986663E+05  0.000 0.11326411E+12  0.000  0.000 0.61731756E+12 0.61731756E+12  0.000 0.47485966E+12 0.23088453E+11 0.23088453E+11  0.000  0.000  6.629"
         write(1,"(a)") "    74.750  0.000  0.000  4487.83669  0.000  0.000 0.23439259E+05 0.23439259E+05  0.000 0.11087597E+12  0.000  0.000 0.57908758E+12 0.57908758E+12  0.000 0.44545198E+12 0.22601639E+11 0.22601639E+11  0.000  0.000  6.490"
         write(1,"(a)") "14  74.750  0.000  0.000  4487.83669  0.000  0.000 0.23439259E+05 0.23439259E+05  0.000 0.11087597E+12  0.000  0.000 0.57908758E+12 0.57908758E+12  0.000 0.44545198E+12 0.22601639E+11 0.22601639E+11  0.000  0.000  6.490"
         write(1,"(a)") "    80.500  0.000  0.000  4391.17381  0.000  0.000 0.21957098E+05 0.21957098E+05  0.000 0.10848782E+12  0.000  0.000 0.54246948E+12 0.54246948E+12  0.000 0.41728422E+12 0.22114826E+11 0.22114826E+11  0.000  0.000  6.351"
         write(1,"(a)") "15  80.500  0.000  0.000  4054.65746  0.000  0.000 0.20287040E+05 0.20287040E+05  0.000 0.10017389E+12  0.000  0.000 0.50120923E+12 0.50120923E+12  0.000 0.38554556E+12 0.20420062E+11 0.20420062E+11  0.000  0.000  6.351"
         write(1,"(a)") "    86.250  0.000  0.000  3965.43018  0.000  0.000 0.18976993E+05 0.18976993E+05  0.000 0.97969452E+11  0.000  0.000 0.46884335E+12 0.46884335E+12  0.000 0.36064873E+12 0.19970696E+11 0.19970696E+11  0.000  0.000  6.211"
         write(1,"(a)") "16  86.250  0.000  0.000  3965.43018  0.000  0.000 0.18976993E+05 0.18976993E+05  0.000 0.97969452E+11  0.000  0.000 0.46884335E+12 0.46884335E+12  0.000 0.36064873E+12 0.19970696E+11 0.19970696E+11  0.000  0.000  6.211"
         write(1,"(a)") "    92.000  0.000  0.000  3876.20291  0.000  0.000 0.17724593E+05 0.17724593E+05  0.000 0.95765013E+11  0.000  0.000 0.43790172E+12 0.43790172E+12  0.000 0.33684748E+12 0.19521330E+11 0.19521330E+11  0.000  0.000  6.072"
         write(1,"(a)") "17  92.000  0.000  0.000  3554.34673  0.000  0.000 0.16263431E+05 0.16263431E+05  0.000 0.87813272E+11  0.000  0.000 0.40180241E+12 0.40180241E+12  0.000 0.30907878E+12 0.17900398E+11 0.17900398E+11  0.000  0.000  6.072"
         write(1,"(a)") "    97.750  0.000  0.000  3472.55506  0.000  0.000 0.15166330E+05 0.15166330E+05  0.000 0.85792537E+11  0.000  0.000 0.37469756E+12 0.37469756E+12  0.000 0.28822889E+12 0.17488479E+11 0.17488479E+11  0.000  0.000  5.933"
         write(1,"(a)") "18  97.750  0.000  0.000  3472.55506  0.000  0.000 0.15166330E+05 0.15166330E+05  0.000 0.85792537E+11  0.000  0.000 0.37469756E+12 0.37469756E+12  0.000 0.28822889E+12 0.17488479E+11 0.17488479E+11  0.000  0.000  5.933"
         write(1,"(a)") "   103.500  0.000  0.000  3390.76339  0.000  0.000 0.14119711E+05 0.14119711E+05  0.000 0.83771802E+11  0.000  0.000 0.34883993E+12 0.34883993E+12  0.000 0.26833841E+12 0.17076560E+11 0.17076560E+11  0.000  0.000  5.794"
         write(1,"(a)") "19 103.500  0.000  0.000  3083.56739  0.000  0.000 0.12849256E+05 0.12849256E+05  0.000 0.76182253E+11  0.000  0.000 0.31745220E+12 0.31745220E+12  0.000 0.24419400E+12 0.15529459E+11 0.15529459E+11  0.000  0.000  5.794"
         write(1,"(a)") "   109.565  0.000  0.000  3005.13755  0.000  0.000 0.11893536E+05 0.11893536E+05  0.000 0.74244575E+11  0.000  0.000 0.29384029E+12 0.29384029E+12  0.000 0.22603099E+12 0.15134471E+11 0.15134471E+11  0.000  0.000  5.647"
         write(1,"(a)") "20 109.565  0.000  0.000  3005.13755  0.000  0.000 0.11893536E+05 0.11893536E+05  0.000 0.74244575E+11  0.000  0.000 0.29384029E+12 0.29384029E+12  0.000 0.22603099E+12 0.15134471E+11 0.15134471E+11  0.000  0.000  5.647"
         write(1,"(a)") "   115.630  0.000  0.000  2926.70772  0.000  0.000 0.10986422E+05 0.10986422E+05  0.000 0.72306897E+11  0.000  0.000 0.27142924E+12 0.27142924E+12  0.000 0.20879173E+12 0.14739483E+11 0.14739483E+11  0.000  0.000  5.500"
         write(1,"(a)") "21 115.630  0.000  0.000     1.000    0.000  0.000 0.1000E+00     0.1000E+00      0.000 0.1000E+13      0.000  0.000 0.1000E+13     0.1000E+13      0.000 0.1000E+13     1.0000E+16     1.0000E+16      0.000  0.000  0.000"
         write(1,"(a)") "   118.380  0.000  0.000     1.000    0.000  0.000 0.1000E+00     0.1000E+00      0.000 0.1000E+13      0.000  0.000 0.1000E+13     0.1000E+13      0.000 0.1000E+13     1.0000E+16     1.0000E+16      0.000  0.000  0.000"
         write(1,*)
         write(1,*)
         write(1,"(a)") "**Tower INNWIND 10MW jacket_rev2 (starts at z=26m)"
         write(1,"(a)") " 1.0000, 0 !mass imbalance, iread"
         write(1,"(a)") "*num     y     x      z           m        xcm      zcm      mIxx            mIzz        mIxz      EA          EAx     EAz      EIxx          EIzz         EIxz       GIt            GAx           GAz        GAxx    GAzz   D[m]"
         write(1,"(a)") " 1   0.000  0.000  0.000   6402.71788    0.000    0.000 0.46667531E+05 0.46667531E+05  0.000 0.17128290E+12  0.000  0.000 0.12484308E+13 0.12484308E+13  0.000 0.96033137E+12 0.34915360E+11 0.34915360E+11  0.000  0.000  7.670"
         write(1,"(a)") "     4.250  0.000  0.000   6316.77255    0.000    0.000 0.44813378E+05 0.44813378E+05  0.000 0.16898372E+12  0.000  0.000 0.11988292E+13 0.11988292E+13  0.000 0.92217633E+12 0.34446682E+11 0.34446682E+11  0.000  0.000  7.567"
         write(1,"(a)") " 2   4.250  0.000  0.000   6316.77255    0.000    0.000 0.44813378E+05 0.44813378E+05  0.000 0.16898372E+12  0.000  0.000 0.11988292E+13 0.11988292E+13  0.000 0.92217633E+12 0.34446682E+11 0.34446682E+11  0.000  0.000  7.567"
         write(1,"(a)") "     8.500  0.000  0.000   6230.82721    0.000    0.000 0.43008999E+05 0.43008999E+05  0.000 0.16668455E+12  0.000  0.000 0.11505592E+13 0.11505592E+13  0.000 0.88504555E+12 0.33978004E+11 0.33978004E+11  0.000  0.000  7.465"
         write(1,"(a)") " 3   8.500  0.000  0.000   5865.88630    0.000    0.000 0.40511653E+05 0.40511653E+05  0.000 0.15692180E+12  0.000  0.000 0.10837512E+13 0.10837512E+13  0.000 0.83365480E+12 0.31987905E+11 0.31987905E+11  0.000  0.000  7.465"
         write(1,"(a)") "    14.250  0.000  0.000   5755.79735    0.000    0.000 0.38273294E+05 0.38273294E+05  0.000 0.15397674E+12  0.000  0.000 0.10238716E+13 0.10238716E+13  0.000 0.78759351E+12 0.31387567E+11 0.31387567E+11  0.000  0.000  7.325"
         write(1,"(a)") " 4  14.250  0.000  0.000   5755.79735    0.000    0.000 0.38273294E+05 0.38273294E+05  0.000 0.15397674E+12  0.000  0.000 0.10238716E+13 0.10238716E+13  0.000 0.78759351E+12 0.31387567E+11 0.31387567E+11  0.000  0.000  7.325"
         write(1,"(a)") "    20.000  0.000  0.000   5645.70841    0.000    0.000 0.36118942E+05 0.36118942E+05  0.000 0.15103169E+12  0.000  0.000 0.96623921E+12 0.96623921E+12  0.000 0.74326093E+12 0.30787229E+11 0.30787229E+11  0.000  0.000  7.186"
         write(1,"(a)") " 5  20.000  0.000  0.000   5294.33132    0.000    0.000 0.33889833E+05 0.33889833E+05  0.000 0.14163179E+12  0.000  0.000 0.90660699E+12 0.90660699E+12  0.000 0.69738999E+12 0.28871096E+11 0.28871096E+11  0.000  0.000  7.186"
         write(1,"(a)") "    25.750  0.000  0.000   5191.49286    0.000    0.000 0.31953112E+05 0.31953112E+05  0.000 0.13888070E+12  0.000  0.000 0.85479663E+12 0.85479663E+12  0.000 0.65753587E+12 0.28310297E+11 0.28310297E+11  0.000  0.000  7.047"
         write(1,"(a)") " 6  25.750  0.000  0.000   5191.49286    0.000    0.000 0.31953112E+05 0.31953112E+05  0.000 0.13888070E+12  0.000  0.000 0.85479663E+12 0.85479663E+12  0.000 0.65753587E+12 0.28310297E+11 0.28310297E+11  0.000  0.000  7.047"
         write(1,"(a)") "    31.500  0.000  0.000   5088.65439    0.000    0.000 0.30091620E+05 0.30091620E+05  0.000 0.13612961E+12  0.000  0.000 0.80499876E+12 0.80499876E+12  0.000 0.61922982E+12 0.27749497E+11 0.27749497E+11  0.000  0.000  6.908"
         write(1,"(a)") " 7  31.500  0.000  0.000   4750.79181    0.000    0.000 0.28109951E+05 0.28109951E+05  0.000 0.12709125E+12  0.000  0.000 0.75198594E+12 0.75198594E+12  0.000 0.57845072E+12 0.25907062E+11 0.25907062E+11  0.000  0.000  6.908"
         write(1,"(a)") "    37.250  0.000  0.000   4654.46398    0.000    0.000 0.26434519E+05 0.26434519E+05  0.000 0.12451432E+12  0.000  0.000 0.70716547E+12 0.70716547E+12  0.000 0.54397344E+12 0.25381766E+11 0.25381766E+11  0.000  0.000  6.768"
         write(1,"(a)") " 8  37.250  0.000  0.000   4654.46398    0.000    0.000 0.26434519E+05 0.26434519E+05  0.000 0.12451432E+12  0.000  0.000 0.70716547E+12 0.70716547E+12  0.000 0.54397344E+12 0.25381766E+11 0.25381766E+11  0.000  0.000  6.768"
         write(1,"(a)") "    43.000  0.000  0.000   4558.13615    0.000    0.000 0.24827020E+05 0.24827020E+05  0.000 0.12193740E+12  0.000  0.000 0.66416231E+12 0.66416231E+12  0.000 0.51089408E+12 0.24856470E+11 0.24856470E+11  0.000  0.000  6.629"
         write(1,"(a)") " 9  43.000  0.000  0.000   4233.83740    0.000    0.000 0.23074565E+05 0.23074565E+05  0.000 0.11326189E+12  0.000  0.000 0.61728135E+12 0.61728135E+12  0.000 0.47483181E+12 0.23088001E+11 0.23088001E+11  0.000  0.000  6.629"
         write(1,"(a)") "    48.750  0.000  0.000   4144.71073    0.000    0.000 0.21647810E+05 0.21647810E+05  0.000 0.11087761E+12  0.000  0.000 0.57911338E+12 0.57911338E+12  0.000 0.44547183E+12 0.22601975E+11 0.22601975E+11  0.000  0.000  6.490"
         write(1,"(a)") "10  48.750  0.000  0.000   4144.71073    0.000    0.000 0.21647810E+05 0.21647810E+05  0.000 0.11087761E+12  0.000  0.000 0.57911338E+12 0.57911338E+12  0.000 0.44547183E+12 0.22601975E+11 0.22601975E+11  0.000  0.000  6.490"
         write(1,"(a)") "    54.500  0.000  0.000   4055.58406    0.000    0.000 0.20281115E+05 0.20281115E+05  0.000 0.10849333E+12  0.000  0.000 0.54255211E+12 0.54255211E+12  0.000 0.41734778E+12 0.22115948E+11 0.22115948E+11  0.000  0.000  6.351"
         write(1,"(a)") "11  54.500  0.000  0.000   3744.79981    0.000    0.000 0.18738747E+05 0.18738747E+05  0.000 0.10017936E+12  0.000  0.000 0.50129131E+12 0.50129131E+12  0.000 0.38560870E+12 0.20421177E+11 0.20421177E+11  0.000  0.000  6.351"
         write(1,"(a)") "    60.250  0.000  0.000   3662.23310    0.000    0.000 0.17526409E+05 0.17526409E+05  0.000 0.97970567E+11  0.000  0.000 0.46885936E+12 0.46885936E+12  0.000 0.36066105E+12 0.19970923E+11 0.19970923E+11  0.000  0.000  6.212"
         write(1,"(a)") "12  60.250  0.000  0.000   3662.23310    0.000    0.000 0.17526409E+05 0.17526409E+05  0.000 0.97970567E+11  0.000  0.000 0.46885936E+12 0.46885936E+12  0.000 0.36066105E+12 0.19970923E+11 0.19970923E+11  0.000  0.000  6.212"
         write(1,"(a)") "    66.000  0.000  0.000   3579.66639    0.000    0.000 0.16367523E+05 0.16367523E+05  0.000 0.95761776E+11  0.000  0.000 0.43785731E+12 0.43785731E+12  0.000 0.33681332E+12 0.19520670E+11 0.19520670E+11  0.000  0.000  6.072"
         write(1,"(a)") "13  66.000  0.000  0.000   3282.44596    0.000    0.000 0.15018415E+05 0.15018415E+05  0.000 0.87810656E+11  0.000  0.000 0.40176651E+12 0.40176651E+12  0.000 0.30905116E+12 0.17899865E+11 0.17899865E+11  0.000  0.000  6.072"
         write(1,"(a)") "    71.750  0.000  0.000   3207.03109    0.000    0.000 0.14006871E+05 0.14006871E+05  0.000 0.85793188E+11  0.000  0.000 0.37470609E+12 0.37470609E+12  0.000 0.28823546E+12 0.17488611E+11 0.17488611E+11  0.000  0.000  5.933"
         write(1,"(a)") "14  71.750  0.000  0.000   3207.03109    0.000    0.000 0.14006871E+05 0.14006871E+05  0.000 0.85793188E+11  0.000  0.000 0.37470609E+12 0.37470609E+12  0.000 0.28823546E+12 0.17488611E+11 0.17488611E+11  0.000  0.000  5.933"
         write(1,"(a)") "    77.500  0.000  0.000   3131.61621    0.000    0.000 0.13041799E+05 0.13041799E+05  0.000 0.83775720E+11  0.000  0.000 0.34888889E+12 0.34888889E+12  0.000 0.26837607E+12 0.17077358E+11 0.17077358E+11  0.000  0.000  5.794"
         write(1,"(a)") "15  77.500  0.000  0.000   2847.91029    0.000    0.000 0.11868480E+05 0.11868480E+05  0.000 0.76186135E+11  0.000  0.000 0.31750073E+12 0.31750073E+12  0.000 0.24423133E+12 0.15530251E+11 0.15530251E+11  0.000  0.000  5.794"
         write(1,"(a)") "    83.565  0.000  0.000   2775.40547    0.000    0.000 0.10984891E+05 0.10984891E+05  0.000 0.74246516E+11  0.000  0.000 0.29386334E+12 0.29386334E+12  0.000 0.22604872E+12 0.15134867E+11 0.15134867E+11  0.000  0.000  5.647"
         write(1,"(a)") "16  83.565  0.000  0.000   2775.40547    0.000    0.000 0.10984891E+05 0.10984891E+05  0.000 0.74246516E+11  0.000  0.000 0.29386334E+12 0.29386334E+12  0.000 0.22604872E+12 0.15134867E+11 0.15134867E+11  0.000  0.000  5.647"
         write(1,"(a)") "    89.630  0.000  0.000   2702.90066    0.000    0.000 0.10146284E+05 0.10146284E+05  0.000 0.72306897E+11  0.000  0.000 0.27142924E+12 0.27142924E+12  0.000 0.20879173E+12 0.14739483E+11 0.14739483E+11  0.000  0.000  5.500"
         write(1,"(a)") "17  89.630  0.000  0.000      1.000   0.000  0.000  0.1000E+00     0.1000E+00     0.000  0.1000E+13     0.000  0.000  0.1000E+13     0.1000E+13     0.000  0.1000E+13     1.0000E+16      1.0000E+16    0.000  0.000  0.000"
         write(1,"(a)") "    92.380  0.000  0.000      1.000   0.000  0.000  0.1000E+00     0.1000E+00     0.000  0.1000E+13     0.000  0.000  0.1000E+13     0.1000E+13     0.000  0.1000E+13     1.0000E+16      1.0000E+16    0.000  0.000  0.000"
      close (1)
   !--->

   ! read blade's aerodynamics
   !--->
      open(unit=1, file=trim(adjustl(path_dir))//"/data.dir/blade_aerodynamics.dat")
         read(1,*)
         do i=1,41
            read(1,*) ukn, rad41(i), x_aer41(i), z_aer41(i)
         end do
      close (1)
   !--->

   ! calculate chord and twist of blade's aerodynamics caractiristics
   !--->
      do i=1,41
         do j=1,29
            if ((rad41(i)>=rad30(j)).and.(rad41(i)<rad30(j+1))) then
               cho41(i)=cho30(j)+(rad41(i)-rad30(j))*(cho30(j+1)-cho30(j))/(rad30(j+1)-rad30(j))
               twi41(i)=twi30(j)+(rad41(i)-rad30(j))*(twi30(j+1)-twi30(j))/(rad30(j+1)-rad30(j))
            end if
         end do
      end do
   !--->

   ! write "geomb.inp"
   !--->
      open(unit=1, file=trim(adjustl(path_dir))//"/model/geomb.inp")
         write(1,"(a)") "** Input geometry for INNWIND 10MW wind turbine"
         write(1,"(a)") "41 ! NSPANB"
         write(1,"(a)") "** r[m] chord[m] twist[deg] x_aer[m] z_aer[m]"
         write(1,"(5(f15.7,3x))") rad41(1), cho41(2), -twi41(2), (cos(4.0*atan(1.0)*twi41(1)/180.0))*x_aer41(1)-(sin(4.0*atan(1.0)*twi41(1)/180.0))*z_aer41(1), (sin(4.0*atan(1.0)*twi41(1)/180.0))*x_aer41(1)+(cos(4.0*atan(1.0)*twi41(1)/180.0))*z_aer41(1)
         do i=2,41
            write(1,"(5(f15.7,3x))") rad41(i), cho41(i), -twi41(i), (cos(4.0*atan(1.0)*twi41(i)/180.0))*x_aer41(i)-(sin(4.0*atan(1.0)*twi41(i)/180.0))*z_aer41(i), (sin(4.0*atan(1.0)*twi41(i)/180.0))*x_aer41(i)+(cos(4.0*atan(1.0)*twi41(i)/180.0))*z_aer41(i)
         end do
      close (1)
   !--->

end program model_create
!---------------------------------------------------------------------------------------------------------------------------------------------------!
!                                                                       -END-                                                                       !
!---------------------------------------------------------------------------------------------------------------------------------------------------!
